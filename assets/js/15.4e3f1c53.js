(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{407:function(t,s,a){"use strict";a.r(s);var n=a(54),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"асинхронные-проваидеры"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#асинхронные-проваидеры"}},[t._v("#")]),t._v(" Асинхронные провайдеры")]),t._v(" "),a("p",[t._v("Иногда запуск приложения должен быть отложен до завершения одной или нескольких "),a("strong",[t._v("асинхронных задач")]),t._v(". Например,\nвы можете не начинать принимать запросы, пока не будет установлено соединение с базой данных. Этого можно добиться с помощью\nасинхронных провайдеров.")]),t._v(" "),a("p",[t._v("Синтаксис для этого заключается в использовании "),a("code",[t._v("async/await")]),t._v(" с синтаксисом "),a("code",[t._v("useFactory")]),t._v(". Фабрика возвращает "),a("code",[t._v("Promise")]),t._v(",\nа функция фабрики использует "),a("code",[t._v("await")]),t._v(" асинхронных задач. Nest будет ожидать разрешения промиса перед инстанцированием любого\nкласса, который зависит от такого провайдера.")]),t._v(" "),a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  provide"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ASYNC_CONNECTION'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("useFactory")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" connection "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("Подробнее о синтаксисе пользовательских провайдеров "),a("a",{attrs:{href:"/guide/fundamentals/custom-providers"}},[t._v("здесь")]),t._v(".")])]),t._v(" "),a("h2",{attrs:{id:"внедрение"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#внедрение"}},[t._v("#")]),t._v(" Внедрение")]),t._v(" "),a("p",[t._v("Асинхронные провайдеры инжектируются в другие компоненты с помощью своих маркеров, как и любой другой провайдер.\nВ примере выше вы бы использовали конструкцию "),a("code",[t._v("@Inject('ASYNC_CONNECTION')")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"пример"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#пример"}},[t._v("#")]),t._v(" Пример")]),t._v(" "),a("p",[a("a",{attrs:{href:"/guide/recipes/sql-typeorm"}},[t._v("В рецепте TypeORM")]),t._v(" есть более содержательный пример асинхронного провайдера.")])])}),[],!1,null,null,null);s.default=e.exports}}]);